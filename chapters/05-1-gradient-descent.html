<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lectures on Machine Learning - 5&nbsp; Gradient Descent</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/05-logistic-regression.html" rel="next">
<link href="../chapters/04-naive-bayes.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Gradient Descent</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Lectures on Machine Learning</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-linear-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-pca.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Principal Component Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability and Bayes Theorem</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-naive-bayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Naive Bayes classification method</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-1-gradient-descent.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Gradient Descent</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-logistic-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-svm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/20-references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
$$
    \newcommand{\df}[1]{\frac{\partial}{\partial #1}}
$$



<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Gradient Descent</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Suppose that we have a function <span class="math inline">\(f(x_0,\ldots, x_{k-1})\)</span> and we wish to find its minimum value. To apply gradient descent, we choose an initial starting point <span class="math inline">\(c=(c_0,\ldots, c_{k-1})\)</span> and we iteratively adjust the values of <span class="math inline">\(c\)</span> so that the values <span class="math inline">\(f(c)\)</span> decrease. When we can no longer do that, we’ve found what is at least a local minimum of <span class="math inline">\(f\)</span>.</p>
<p>How should we make these adjustments? Let us remember the idea of the <em>directional derivative</em> from multivariate calculus. The directional derivative <span class="math inline">\(D_{v}f\)</span> measures the rate of change of <span class="math inline">\(f\)</span> as one moves with velocity vector <span class="math inline">\(v\)</span> from the point <span class="math inline">\(x\)</span> and it is defined as <span class="math display">\[
D_{v}f(x) = \frac{d}{dt}f(x+tv)|_{t=0}
\]</span> From the chain rule, we can compute that <span class="math display">\[
D_{v}f(x) = \sum_{i=0}^{k-1} \frac{\partial f}{\partial x_{i}}\frac{dx_{i}}{dt} = (\nabla f)\cdot v
\]</span> where <span class="math display">\[
\nabla f = \left[\frac{\partial f}{\partial x_{i}}\right]_{i=0}^{k-1}
\]</span> is the gradient of <span class="math inline">\(f\)</span>. This argument yields the following result.</p>
<p><strong>Proposition:</strong> Let <span class="math inline">\(f(x_0,\ldots, x_{k-1})\)</span> be a smooth function from <span class="math inline">\(\mathbb{R}^{k}\to\mathbb{R}\)</span>. Then for every point <span class="math inline">\(c=(c_0,\ldots, c_{k-1})\)</span>, if <span class="math inline">\(\nabla f\not=0\)</span> then <span class="math inline">\(\nabla f\)</span> is a vector pointing in the direction in which <span class="math inline">\(f\)</span> increases most rapidly, and <span class="math inline">\(-\nabla f\)</span> is a vector pointing in the direction in which <span class="math inline">\(f\)</span> decreases most rapidly. If <span class="math inline">\(\nabla f = 0\)</span>, then <span class="math inline">\(c\)</span> is a critical point of <span class="math inline">\(f\)</span>.</p>
<p><strong>Proof:</strong> The directional derivative <span class="math inline">\(D_{v}(f)=(\nabla f)\cdot v\)</span> measures the rate of change of <span class="math inline">\(f\)</span> if we travel with velocity <span class="math inline">\(v\)</span> from a point <span class="math inline">\(x\)</span>. To remove the dependence on the magnitude of <span class="math inline">\(v\)</span> (since obviously <span class="math inline">\(f\)</span> will change more quickly if we travel more quickly in a given direction), we scale <span class="math inline">\(v\)</span> to be a unit vector. Then the dot product giving the rate is maximized when <span class="math inline">\(v\)</span> is parallel to <span class="math inline">\(\nabla f\)</span>.</p>
<p>This observation about the gradient yields the algorithm for gradient descent.</p>
<p><strong>Gradient Descent Algorithm:</strong> Given a function <span class="math inline">\(f:\mathbb{R}^{k}\to \mathbb{R}\)</span>, choose a point <span class="math inline">\(c^{(0)}\)</span>, a small constant <span class="math inline">\(\nu\)</span> (called the <em>learning rate</em>) and a small constant <span class="math inline">\(\epsilon\)</span> (the <em>tolerance</em>). Then iteratively compute <span class="math display">\[
c^{(n+1)}=c^{(n)} -\nu\nabla f(c^{(n)})
\]</span> until <span class="math inline">\(|c^{(n+1)}-c^{(n)}|&lt;\epsilon\)</span>. Then <span class="math inline">\(c^{(n+1)}\)</span> is an (approximate) critical point of <span class="math inline">\(f\)</span>.</p>
<div id="fig-graddescentillust" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/GradientDescentIllustration.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.1: Gradient Descent</figcaption><p></p>
</figure>
</div>
<p>The behavior of gradient descent is illustrated in <a href="#fig-graddescentillust">Figure&nbsp;<span>5.1</span></a> for the function <span class="math display">\[
f(x,y) = \frac{xy}{\sigma\sqrt{2\pi}}e^{(-x^2-y^2)/2\sigma^2}
\]</span> where <span class="math inline">\(\sigma=4\)</span>. This function has two “upward” humps and two “downward” humps. Starting on the inside slope of one of the upward humps, gradient descent finds the bottom of an adjacent “downward” hump.</p>
<p>To get a little more perspective on gradient descent, consider the one-dimensional case, with <span class="math inline">\(f(x)=4x^3-6x^2\)</span>. This is a cubic polynomial whose graph has a local maximum and a local minimum, depicted in <a href="#fig-graddescentcubic">Figure&nbsp;<span>5.2</span></a>.</p>
<div id="fig-graddescentcubic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/GradDescentCubic.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.2: A cubic polynomial</figcaption><p></p>
</figure>
</div>
<p>In this case the gradient is just the derivative <span class="math inline">\(f'(x)=12x^2-12x\)</span> and the iteration is <span class="math display">\[
c^{(n+1)} = c^{(n)}-12\nu((c^{(n)})^2-c^{(n)}).
\]</span></p>
<p>Even from this simple example we can see the power and also the pitfalls of this method. Suppose we choose <span class="math inline">\(x_0=2\)</span>, <span class="math inline">\(\nu=.01\)</span>, and <span class="math inline">\(\epsilon=.001\)</span>. Then the iteration yields:</p>
<div id="tbl-graddescentiters" class="anchored">
<table class="table">
<caption>Table&nbsp;5.1: Gradient Descent Iterations</caption>
<thead>
<tr class="header">
<th>Step</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x</td>
<td>2.0</td>
<td>0.8</td>
<td>0.896</td>
<td>0.952</td>
<td>0.979</td>
<td>0.991</td>
<td>0.997</td>
</tr>
</tbody>
</table>
</div>
<p>As you can see, the points move quickly to the (local) minimum at <span class="math inline">\(x=1\)</span>.</p>
<p>There are two ways (at least) that things can go wrong, however. First suppose we use <span class="math inline">\(x_0=-1\)</span>, instead of <span class="math inline">\(x_0=2\)</span>, as our first guess. Then we are on the downslope on the left side of the graph, and following the gradient quickly takes us off to <span class="math inline">\(-\infty\)</span>.</p>
<div id="tbl-graddescentfailone" class="anchored">
<table class="table">
<caption>Table&nbsp;5.2: Gradient Descent Iterations (first failure mode)</caption>
<thead>
<tr class="header">
<th>Step</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x</td>
<td>-1.00</td>
<td>-2.20</td>
<td>-6.42</td>
<td>-35.04</td>
<td>-792.70</td>
<td>-378296.27</td>
</tr>
</tbody>
</table>
</div>
<p>Second, suppose we choose <span class="math inline">\(x_0=2\)</span>, but choose a somewhat larger learning rate – say, <span class="math inline">\(\nu=.1\)</span>. In this case, initially things look good, but the addition of the gradient causes an overshoot which once again takes us over the hump at <span class="math inline">\(x=0\)</span> and off to <span class="math inline">\(-\infty\)</span> heading to the left.</p>
<div id="tbl-graddescentfailetwo" class="anchored">
<table class="table">
<caption>Table&nbsp;5.3: Gradient Descent Iterations (second failure mode)</caption>
<thead>
<tr class="header">
<th>Step</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>x</td>
<td>2.00</td>
<td>-0.11</td>
<td>-0.24</td>
<td>-0.56</td>
<td>-1.49</td>
<td>-5.42</td>
<td>-42.23</td>
</tr>
</tbody>
</table>
</div>
<p>Based on these considerations, we see that, for general functions, <em>if gradient descent converges,</em> then it will converge to a local minimum of the function. But <em>it may not converge,</em> and even if it does, we can’t conclude anything about whether we’ve reached a <em>global</em> minimum.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/04-naive-bayes.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Naive Bayes classification method</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/05-logistic-regression.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">© 2021. This work is licensed by Jeremy Teitelbaum under the <a href="http://creativecommons.org/licenses/by-sa/4.0">Creative Commons Attribution-ShareAlike License</a>.</div>
  </div>
</footer>



</body></html>